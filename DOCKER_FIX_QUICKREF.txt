â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                   â•‘
â•‘           ğŸ”§ DOCKER BUILD FIX - QUICK REFERENCE                   â•‘
â•‘                                                                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PROBLEM SOLVED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ— npm ci fails due to package-lock.json sync issues
âœ— Build hangs downloading Puppeteer Chromium
âœ— Corrupted node_modules causing build failures

SOLUTION APPLIED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… Changed npm ci â†’ npm install (more flexible)
âœ… Added PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=true
âœ… Added PUPPETEER_SKIP_DOWNLOAD=true
âœ… Created cleanup script to remove corrupted files

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš¡ QUICK FIX (ONE COMMAND)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Run this command to fix everything:

    cd /data/workspace/arb && ./cleanup-and-rebuild.sh

This will:
  1. Stop all containers
  2. Remove corrupted node_modules and package-lock.json
  3. Remove old Docker images
  4. Rebuild everything fresh
  5. Start all services
  6. Show status and logs

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ WHAT WAS CHANGED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. engine/Dockerfile
   BEFORE: RUN npm ci --only=production
   AFTER:  ENV PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=true
           ENV PUPPETEER_SKIP_DOWNLOAD=true
           RUN npm install --omit=dev

2. frontend/Dockerfile
   BEFORE: RUN npm ci
   AFTER:  ENV PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=true
           ENV PUPPETEER_SKIP_DOWNLOAD=true
           RUN npm install

3. Created: cleanup-and-rebuild.sh
   - Automated cleanup and rebuild script
   - Removes all corrupted files
   - Rebuilds with --no-cache

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ EXECUTION STEPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 1: Navigate to project directory
$ cd /data/workspace/arb

STEP 2: Run cleanup script
$ ./cleanup-and-rebuild.sh

STEP 3: Wait for completion (3-5 minutes)

STEP 4: Verify services
$ docker compose ps

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… VERIFY SUCCESS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Check 1: Container Status
$ docker compose ps
Expected: All containers "Up"

Check 2: Engine Health
$ curl http://localhost:3000/health
Expected: JSON response

Check 3: Frontend Access
$ curl http://localhost:5173
Expected: HTML response

Check 4: View Logs
$ docker logs arb-engine
$ docker logs arb-frontend
Expected: No errors

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸŒ ACCESS POINTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

After successful build:

â€¢ Engine API:    http://localhost:3000
â€¢ Frontend UI:   http://localhost:5173
â€¢ Prometheus:    http://localhost:9090
â€¢ Grafana:       http://localhost:3030
â€¢ PgAdmin:       http://localhost:5050

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ” TROUBLESHOOTING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

If build still fails:

1. Check Docker disk space:
   $ docker system df
   $ docker system prune -a

2. View detailed build logs:
   $ docker compose build --no-cache --progress=plain

3. Check individual service logs:
   $ docker compose logs engine
   $ docker compose logs frontend

4. Restart specific service:
   $ docker compose restart engine

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š BUILD TIMES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Expected durations:
â€¢ Cleanup:       ~30 seconds
â€¢ Build:         ~3-5 minutes
â€¢ Startup:       ~2-3 minutes
â€¢ Total:         ~6-9 minutes

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“š DOCUMENTATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Full details:
â€¢ DOCKER_BUILD_FIX.md  â†’ Complete documentation
â€¢ cleanup-and-rebuild.sh â†’ Automation script
â€¢ This file â†’ Quick reference

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸš€ READY TO RUN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Just execute:

    ./cleanup-and-rebuild.sh

And wait for the system to come up! âœ…

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

MANUAL ALTERNATIVE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

If you prefer manual steps:

# Stop services
$ docker compose down

# Clean files
$ rm -rf engine/node_modules engine/package-lock.json
$ rm -rf frontend/node_modules frontend/package-lock.json

# Remove old images
$ docker rmi arb-engine arb-frontend

# Rebuild and start
$ docker compose build --no-cache
$ docker compose up -d

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Good luck! ğŸ€
